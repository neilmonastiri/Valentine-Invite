<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valentine</title>
  <style>
    :root {
      --bg-1: #0a1026;
      --bg-2: #2a1738;
      --bg-3: #4b1f4b;
      --glass: rgba(255, 243, 249, 0.1);
      --line: rgba(255, 221, 236, 0.28);
      --text: #fff6fb;
      --pink: #ff7fb8;
      --pink-strong: #ff5da4;
      --muted: #c49ab4;
      --shadow: 0 26px 60px rgba(8, 5, 16, 0.52);
    }

    * { box-sizing: border-box; }
    html, body { margin: 0; min-height: 100%; }

    body {
      font-family: "Inter", "Segoe UI", system-ui, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 8% -10%, rgba(255, 177, 218, 0.22), transparent 45%),
        radial-gradient(900px 520px at 95% 110%, rgba(255, 129, 197, 0.18), transparent 52%),
        linear-gradient(165deg, var(--bg-1), var(--bg-2) 52%, var(--bg-3));
      overflow: hidden;
    }

    .petal-layer, .sparkle-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      overflow: hidden;
    }

    .petal {
      position: absolute;
      top: -15vh;
      width: clamp(8px, 2vw, 14px);
      height: clamp(6px, 1.5vw, 10px);
      border-radius: 80% 20% 72% 28%;
      background: radial-gradient(circle at 28% 30%, #ffeff8, #ffc2dc 76%);
      opacity: 0.7;
      animation: fall linear infinite;
      transform: rotate(20deg);
      pointer-events: auto;
      cursor: pointer;
    }

    @keyframes fall {
      from { transform: translate3d(0, -8vh, 0) rotate(0deg); }
      to { transform: translate3d(var(--drift), 108vh, 0) rotate(280deg); }
    }

    .scene-dim {
      position: fixed;
      inset: 0;
      background: rgba(6, 4, 14, 0.36);
      opacity: 0;
      transition: opacity .35s ease;
      z-index: 3;
      pointer-events: none;
    }

    .scene-dim.show { opacity: 1; }

    main {
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 1rem;
      position: relative;
      z-index: 4;
    }

    .stage {
      width: min(92vw, 560px);
      min-height: 320px;
      display: grid;
      place-items: center;
    }

    .egg-wrap {
      position: relative;
      width: min(240px, 66vw);
      aspect-ratio: 0.75;
      display: grid;
      place-items: center;
      cursor: pointer;
      transition: transform .2s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .egg-wrap:active { transform: scale(.98); }

    .egg-shell {
      position: absolute;
      inset: 0;
      border-radius: 50% 50% 46% 46% / 58% 58% 42% 42%;
      background:
        radial-gradient(circle at 34% 24%, rgba(255, 255, 255, 0.8), transparent 28%),
        radial-gradient(circle at 65% 66%, rgba(255, 194, 227, 0.16), transparent 35%),
        linear-gradient(180deg, #fff2f8, #ffe1ef 64%, #ffd4e8);
      border: 1px solid rgba(255, 210, 232, 0.8);
      box-shadow:
        0 0 35px rgba(255, 183, 221, 0.46),
        0 20px 40px rgba(7, 5, 16, 0.5);
      transition: transform .32s ease, opacity .35s ease;
    }

    .egg-shell.left,
    .egg-shell.right {
      clip-path: inset(0 0 0 0 round 50% 50% 46% 46% / 58% 58% 42% 42%);
    }

    .egg-shell.left { clip-path: polygon(0 0, 56% 0, 50% 100%, 0 100%); }
    .egg-shell.right { clip-path: polygon(46% 0, 100% 0, 100% 100%, 50% 100%); }

    .egg-shine {
      position: absolute;
      width: 70%;
      height: 70%;
      border-radius: 50%;
      background: radial-gradient(circle at 40% 30%, rgba(255, 255, 255, 0.75), transparent 48%);
      filter: blur(1px);
      pointer-events: none;
      z-index: 2;
    }

    .cracks {
      position: absolute;
      inset: 6% 10% 8%;
      pointer-events: none;
      z-index: 3;
    }

    .crack-line {
      position: absolute;
      background: linear-gradient(180deg, rgba(178, 114, 150, 0.1), rgba(152, 86, 127, 0.55));
      border-radius: 999px;
      opacity: 0;
      transform-origin: top center;
      transition: opacity .2s ease;
    }

    .c1 { width: 3px; height: 28%; left: 52%; top: 16%; transform: rotate(10deg); }
    .c2 { width: 3px; height: 26%; left: 45%; top: 26%; transform: rotate(-26deg); }
    .c3 { width: 3px; height: 23%; left: 56%; top: 35%; transform: rotate(29deg); }
    .c4 { width: 2px; height: 19%; left: 40%; top: 40%; transform: rotate(-42deg); }
    .c5 { width: 2px; height: 17%; left: 60%; top: 47%; transform: rotate(42deg); }
    .c6 { width: 2px; height: 14%; left: 49%; top: 56%; transform: rotate(8deg); }

    .egg-wrap[data-crack="1"] .c1,
    .egg-wrap[data-crack="2"] .c1,
    .egg-wrap[data-crack="2"] .c2,
    .egg-wrap[data-crack="3"] .c1,
    .egg-wrap[data-crack="3"] .c2,
    .egg-wrap[data-crack="3"] .c3,
    .egg-wrap[data-crack="4"] .c1,
    .egg-wrap[data-crack="4"] .c2,
    .egg-wrap[data-crack="4"] .c3,
    .egg-wrap[data-crack="4"] .c4,
    .egg-wrap[data-crack="5"] .c1,
    .egg-wrap[data-crack="5"] .c2,
    .egg-wrap[data-crack="5"] .c3,
    .egg-wrap[data-crack="5"] .c4,
    .egg-wrap[data-crack="5"] .c5,
    .egg-wrap[data-crack="6"] .crack-line,
    .egg-wrap[data-crack="7"] .crack-line {
      opacity: 1;
    }

    .egg-wrap.shake { animation: tapShake .26s ease; }

    @keyframes tapShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-3px) rotate(-1.3deg); }
      50% { transform: translateX(3px) rotate(1.3deg); }
      75% { transform: translateX(-2px) rotate(-.8deg); }
    }

    .egg-wrap.broken .egg-shell.left {
      transform: translate(-44px, 46px) rotate(-22deg);
      opacity: 0;
    }

    .egg-wrap.broken .egg-shell.right {
      transform: translate(44px, 46px) rotate(22deg);
      opacity: 0;
    }

    .egg-wrap.broken .egg-shine,
    .egg-wrap.broken .cracks { opacity: 0; transition: opacity .25s ease; }

    .inner-glow {
      position: absolute;
      width: 60%;
      aspect-ratio: 1;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255, 246, 251, 0.9), rgba(255, 201, 229, 0.38), transparent 70%);
      opacity: 0;
      pointer-events: none;
      filter: blur(1px);
      z-index: 1;
    }

    .egg-wrap.broken .inner-glow { opacity: 1; animation: burstGlow .75s ease; }

    @keyframes burstGlow {
      0% { transform: scale(.72); opacity: .2; }
      40% { transform: scale(1.1); opacity: .95; }
      100% { transform: scale(1.4); opacity: 0; }
    }

    .question-card {
      position: absolute;
      width: min(92vw, 560px);
      border-radius: 22px;
      background: var(--glass);
      border: 1px solid var(--line);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: var(--shadow), 0 0 34px rgba(255, 162, 211, 0.14);
      padding: clamp(1.1rem, 4vw, 1.7rem);
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transform: translateY(8px) scale(.97);
      transition: all .35s ease;
      z-index: 5;
    }

    .question-card.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0) scale(1);
    }

    .question {
      margin: 0;
      font-family: "Cormorant Garamond", Georgia, serif;
      font-size: clamp(2rem, 10vw, 3.3rem);
      line-height: 1.06;
      letter-spacing: .02em;
      color: #fff6fb;
      text-shadow: 0 0 16px rgba(255, 177, 216, 0.36);
    }

    .actions, .confirm-actions {
      margin-top: .9rem;
      display: flex;
      justify-content: center;
      gap: .65rem;
      flex-wrap: wrap;
    }

    .btn {
      border: 0;
      border-radius: 999px;
      padding: .64rem 1.25rem;
      font-size: 1rem;
      cursor: pointer;
      transition: transform .25s ease, box-shadow .25s ease;
    }

    .btn:hover, .btn:focus-visible { transform: translateY(-2px); }

    .yes {
      color: #fff;
      font-weight: 600;
      background: linear-gradient(180deg, var(--pink), var(--pink-strong));
      box-shadow: 0 10px 22px rgba(255, 93, 164, 0.33);
    }

    .no, .muted {
      color: #fff;
      background: linear-gradient(180deg, #cda6bc, #b784a1);
      box-shadow: 0 8px 18px rgba(68, 34, 54, 0.22);
    }

    .confirm {
      margin-top: .75rem;
      border-top: 1px dashed rgba(255, 221, 236, 0.4);
      padding-top: .75rem;
      display: none;
    }

    .confirm.show { display: block; }
    .confirm p { margin: 0; }

    .heart-pop {
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(.6);
      color: #ffd4e9;
      font-size: clamp(2.4rem, 11vw, 4.8rem);
      text-shadow: 0 0 24px rgba(255, 135, 196, 0.65);
      opacity: 0;
      pointer-events: none;
      z-index: 10;
    }

    .heart-pop.show { animation: heartPop .95s ease forwards; }

    @keyframes heartPop {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(.6); }
      35% { opacity: 1; }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(1.2); }
    }

    .sparkle {
      position: absolute;
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: #fff8fc;
      box-shadow: 0 0 8px rgba(255, 201, 230, 0.95);
      animation: sparkle .95s ease forwards;
    }

    @keyframes sparkle {
      from { opacity: 0; transform: translateY(0) scale(.7); }
      30% { opacity: 1; }
      to { opacity: 0; transform: translateY(-18px) scale(1.2); }
    }
  </style>
</head>
<body>
  <div class="petal-layer" id="petalLayer"></div>
  <div class="sparkle-layer" id="sparkleLayer"></div>
  <div class="scene-dim" id="sceneDim"></div>

  <main>
    <section class="stage">
      <div class="egg-wrap" id="egg" role="button" tabindex="0" aria-label="Tap to crack the egg" data-crack="0">
        <div class="egg-shell left"></div>
        <div class="egg-shell right"></div>
        <div class="egg-shine"></div>
        <div class="inner-glow"></div>
        <div class="cracks">
          <span class="crack-line c1"></span>
          <span class="crack-line c2"></span>
          <span class="crack-line c3"></span>
          <span class="crack-line c4"></span>
          <span class="crack-line c5"></span>
          <span class="crack-line c6"></span>
        </div>
      </div>

      <article class="question-card" id="questionCard" aria-live="polite">
        <h1 class="question">Will you be my Valentine?</h1>
        <div class="actions">
          <button class="btn yes" id="yesBtn">Yes</button>
          <button class="btn no" id="noBtn">No</button>
        </div>

        <section class="confirm" id="confirmBox">
          <p>Are you sure?</p>
          <div class="confirm-actions">
            <button class="btn muted" id="sureBtn">Yes, Iâ€™m sure</button>
            <button class="btn yes" id="waitBtn">Waitâ€¦</button>
          </div>
        </section>
      </article>
    </section>
  </main>

  <div class="heart-pop" id="heartPop">ðŸ’–</div>

  <script>
    const petalLayer = document.getElementById('petalLayer');
    const sparkleLayer = document.getElementById('sparkleLayer');
    const sceneDim = document.getElementById('sceneDim');
    const egg = document.getElementById('egg');
    const questionCard = document.getElementById('questionCard');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const confirmBox = document.getElementById('confirmBox');
    const sureBtn = document.getElementById('sureBtn');
    const waitBtn = document.getElementById('waitBtn');
    const heartPop = document.getElementById('heartPop');

    const tapsToBreak = 6;
    let tapCount = 0;
    let opened = false;
    let answeredNo = false;

    function createPetals(count = 14) {
      for (let i = 0; i < count; i++) {
        const petal = document.createElement('div');
        petal.className = 'petal';
        petal.style.left = `${Math.random() * 100}%`;
        petal.style.setProperty('--drift', `${(Math.random() * 95 - 47).toFixed(0)}px`);
        petal.style.animationDuration = `${(Math.random() * 7 + 15).toFixed(2)}s`;
        petal.style.animationDelay = `${(-Math.random() * 8).toFixed(2)}s`;
        petalLayer.appendChild(petal);
      }
    }

    function sparkleBurst(x = innerWidth / 2, y = innerHeight / 2, amount = 24) {
      for (let i = 0; i < amount; i++) {
        const dot = document.createElement('div');
        dot.className = 'sparkle';
        dot.style.left = `${x + (Math.random() * 170 - 85)}px`;
        dot.style.top = `${y + (Math.random() * 120 - 60)}px`;
        sparkleLayer.appendChild(dot);
        setTimeout(() => dot.remove(), 1000);
      }
    }

    function crackEgg() {
      if (opened) return;
      tapCount += 1;
      egg.dataset.crack = String(Math.min(tapCount, tapsToBreak));
      egg.classList.remove('shake');
      void egg.offsetWidth;
      egg.classList.add('shake');
      sparkleBurst(innerWidth * 0.5, innerHeight * 0.5, 8);

      if (tapCount >= tapsToBreak) {
        opened = true;
        egg.classList.add('broken');
        sceneDim.classList.add('show');
        sparkleBurst(innerWidth * 0.5, innerHeight * 0.48, 30);
        setTimeout(() => {
          egg.style.pointerEvents = 'none';
          questionCard.classList.add('show');
        }, 230);
      }
    }

    function celebrateYes() {
      confirmBox.classList.remove('show');
      sparkleBurst(innerWidth * 0.5, innerHeight * 0.52, 58);
      heartPop.classList.remove('show');
      void heartPop.offsetWidth;
      heartPop.classList.add('show');
      document.querySelectorAll('.petal').forEach((petal) => {
        const duration = parseFloat(petal.style.animationDuration);
        petal.style.animationDuration = `${Math.max(7, duration - 5)}s`;
      });
    }

    function onNo() {
      if (answeredNo) return;
      confirmBox.classList.add('show');
    }

    function confirmNo() {
      answeredNo = true;
      confirmBox.classList.remove('show');
      noBtn.disabled = true;
      noBtn.style.opacity = '0.6';
      noBtn.style.cursor = 'default';
    }

    function waitReturn() {
      confirmBox.classList.remove('show');
    }

    egg.addEventListener('click', crackEgg);
    egg.addEventListener('keydown', (event) => {
      if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        crackEgg();
      }
    });

    yesBtn.addEventListener('click', celebrateYes);
    noBtn.addEventListener('click', onNo);
    sureBtn.addEventListener('click', confirmNo);
    waitBtn.addEventListener('click', waitReturn);

    createPetals();
  </script>
</body>
</html>
